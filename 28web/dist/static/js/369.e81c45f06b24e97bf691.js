webpackJsonp([369,588],{"1onU":function(e,a,t){"use strict";var s=t("VT+v"),n=t("juIs");var i=function(e){t("ZdV2"),t("co/t")},r=t("VU/8")(s.a,n.a,i,"data-v-695be8cd",null);a.a=r.exports},"6jol":function(e,a,t){"use strict";var r=t("Vo7i"),s=t("HlqG");a.a={name:"salesmanDialog",props:{innerVisible:{type:Boolean,default:!1},formData:{type:Object,default:{formTitle:"",formRow:{}}}},data:function(){return{loading:!0,list:[],userList:[],subFormData:{groupName:"",remarks:""}}},methods:{handleClose:function(){this.$parent.$parent.innerVisible=!1,this.$parent.$parent.formData={},this.$refs.formData.resetFields()},getGroupList:function(){var a=this;"修改业务员培训分组"===this.formData.formTitle&&Object(r.a)({url:"/"+this.$cms+"/usercenter/aflcsalesmanlearninggroup/v1/"+this.formData.formRow.id,method:"get"}).then(function(e){200===e.status?(a.userList=[],e.data.userList.forEach(function(e){a.userList.push(e.userId)}),a.subFormData.groupName=e.data.groupName,a.subFormData.remarks=e.data.remarks):a.$message.warning(e.errorInfo)}).catch(function(e){a.$message.warning(e.errorInfo)})},getSalesman:function(){var a=this;this.loading=!0,Object(s.b)({currentPage:1,pageSize:500,vo:{groupCode:"101"},groupCode:"101"}).then(function(e){a.loading=!1,a.list=[],e.data.list.forEach(function(e){a.list.push({userId:e.userId,label:e.name+","+e.mobile})})}).catch(function(e){a.$message({type:"info",message:"操作失败，原因："+(e.errorInfo?e.errorInfo:e.text)}),a.loading=!1})},saveSalesman:function(e,a){var t=[];return a.forEach(function(a){e.map(function(e){a===e.userId&&t.push({userId:a,salesmanName:e.label.slice(0,e.label.indexOf(",")),salesmanMobile:e.label.slice(e.label.indexOf(",")+1)})})}),t},sure:function(a){var t=this,s="修改业务员培训分组"===this.formData.formTitle,n={id:s?this.formData.formRow.id:void 0,groupName:this.subFormData.groupName,remarks:this.subFormData.remarks,userList:this.saveSalesman(this.list,this.userList)},i=s?"/usercenter/aflcsalesmanlearninggroup/v1/update":"/usercenter/aflcsalesmanlearninggroup/v1/add";this.$refs[a].validate(function(e){if(!e)return!1;Object(r.a)({url:"/"+t.$cms+i,method:"post",data:n}).then(function(e){200===e.status?(s?t.$message.success("修改成功"):t.$message.success("新增成功"),t.handleClose(a),t.$emit("changge",!0)):t.$message.warning(e.errorInfo)}).catch(function(e){t.$message.warning(e.errorInfo)})})}},created:function(){this.getGroupList(),this.getSalesman()}}},B9C1:function(e,a,t){"use strict";var s={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"salesmanDialog"},[t("el-dialog",{attrs:{width:"40%",title:a.formData.formTitle,visible:a.innerVisible,"before-close":a.handleClose,"append-to-body":"",center:""}},[t("el-form",{ref:"formData",attrs:{model:a.subFormData,"label-position":"right","label-width":"130px"}},[t("el-form-item",{attrs:{label:"组名 ：",prop:"groupName",rules:{required:!0,message:"请输入组名",trigger:"change"}}},[t("el-input",{staticStyle:{"line-height":"38px"},attrs:{placeholder:"请输入组名",maxlength:"25","show-word-limit":""},model:{value:a.subFormData.groupName,callback:function(e){a.$set(a.subFormData,"groupName",e)},expression:"subFormData.groupName"}})],1),a._v(" "),t("el-form-item",{attrs:{label:"描述 ：",prop:"remarks",rules:{required:!0,message:"请输入描述",trigger:"change"}}},[t("el-input",{staticStyle:{resize:"none"},attrs:{type:"textarea",placeholder:"请输入描述",maxlength:"50","show-word-limit":""},model:{value:a.subFormData.remarks,callback:function(e){a.$set(a.subFormData,"remarks",e)},expression:"subFormData.remarks"}})],1)],1),a._v(" "),t("el-transfer",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"transfer",attrs:{props:{key:"userId",label:"label"},titles:["所有业务员","可见业务员"],data:a.list},model:{value:a.userList,callback:function(e){a.userList=e},expression:"userList"}}),a._v(" "),t("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[t("el-button",{attrs:{type:"primary",size:"mini",plain:"",icon:"el-icon-success"},on:{click:function(e){a.sure("formData")}}},[a._v("确定")]),a._v(" "),t("el-button",{attrs:{type:"primary",size:"mini",plain:"",icon:"el-icon-error"},on:{click:function(e){a.handleClose("formData")}}},[a._v("取消")])],1)],1)],1)},staticRenderFns:[]};a.a=s},DFLe:function(e,a,t){"use strict";var s=t("Vo7i"),n=t("1onU"),i=t("cx3P");a.a={name:"learningGroupManagement",props:{showLearningGroup:{default:!1,type:Boolean}},data:function(){return{tableData:[],page:1,pagesize:20,dataTotal:0,innerVisible:!1,formData:{formTitle:"",formRow:{}},loading:!0}},components:{Pager:n.a,salesmanDialog:i.default},methods:{changge:function(e){e&&this.query()},handlePageChange:function(e){this.page=e.pageNum,this.pagesize=e.pageSize,this.query()},handleClose:function(e){this.$parent.showLearningGroup=!1},handleClick:function(e,a){this.innerVisible=!0,"add"==e?this.formData.formTitle="新增业务员培训分组":(this.formData.formTitle="修改业务员培训分组",this.formData.formRow=a)},query:function(){var a=this,e={pageNum:this.page,pageSize:this.pagesize};this.loading=!0,Object(s.a)({url:"/"+this.$cms+"/usercenter/aflcsalesmanlearninggroup/v1/list",method:"post",data:e}).then(function(e){a.loading=!1,200===e.status?(a.tableData=e.data.list,a.dataTotal=e.data.total):a.$message.warning(e.errorInfo)}).catch(function(e){a.loading=!1,a.$message.warning(e.errorInfo)})}},created:function(){this.query()}}},HlqG:function(e,a,t){"use strict";a.c=function(){return s.a.get("/"+n+"/usercenter/aflcBusinessGroup/v1/tree")},a.b=function(e){return Object(s.a)({url:"/"+n+"/usercenter/aflcBusinessGroupUser/v1/list",method:"post",data:e})},a.a=function(e){return Object(s.a)({url:"/"+n+"/usercenter/aflcBusinessGroup/v1/addGroupAndUsers",method:"post",data:e})},a.e=function(e){return Object(s.a)({url:"/"+n+"/usercenter/aflcBusinessGroup/v1/updateGroupAndUsers",method:"put",data:e})},a.d=function(e){return s.a.get("/"+n+"/usercenter/aflcBusinessGroup/v1/selectGroupAndUsers/"+e)};var s=t("Vo7i"),n="aflc-uc"},LEHp:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=t("DFLe"),n=t("g7j8"),i=t("VU/8")(s.a,n.a,null,null,null);a.default=i.exports},"VT+v":function(e,a,t){"use strict";a.a={props:{sizes:{type:Array,default:function(){return[20,50,100,400]}},total:{type:Number,default:0},pageLog:{type:Number,default:1}},computed:{pages:function(){return Math.ceil(this.total/this.size)}},watch:{pageNum:function(){this.inputval=this.pageNum},size:function(){1==this.pageLog&&(this.pageNum=1)}},mounted:function(){this.size=this.sizes[0],this.pageNum=this.pageLog},data:function(){return{pageNum:1,oldValue:0,inputval:1,oldNum:1,size:100}},methods:{handleFocus:function(e){this.oldValue=e.target.value},sizesChange:function(){this.pageNum=1,this.oldNum=this.pageNum,this.$emit("change",{pageNum:this.pageNum,pageSize:this.size})},changeEvent:function(){this.oldNum!==this.pageNum&&(this.oldNum=this.pageNum,this.$emit("change",{pageNum:this.pageNum,pageSize:this.size}))},handleCurrentChange:function(e){this.pageNum=e,this.changeEvent()},handleSizeChange:function(e){this.size=e,this.changeEvent()},handleChange:function(e){var a=parseInt(e,10);isNaN(a)?this.inputval=1:a<1?this.inputval=1:a>this.pages?this.inputval=this.pages:this.inputval=a},handleBlur:function(e){var a=e.target;this.handleChange(a.value),this.jumpTo(this.inputval)},handleKeyup:function(e){var a=e.keyCode,t=e.target;console.log("page keydown:",a,t),13===a&&this.oldValue&&t.value!==this.oldValue&&(this.handleChange(t.value),this.oldValue="")},jumpTo:function(e){console.log("d",this.inputval),e<1?this.pageNum=1:e>this.pages?this.pageNum=this.pages:this.pageNum=e,this.changeEvent()}}}},ZdV2:function(e,a){},"co/t":function(e,a){},cx3P:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=t("6jol"),n=t("B9C1");var i=function(e){t("xxjM")},r=t("VU/8")(s.a,n.a,i,"data-v-b841e6ea",null);a.default=r.exports},g7j8:function(e,a,t){"use strict";var s={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{title:"学习分组管理",visible:t.showLearningGroup,width:"70%","before-close":t.handleClose}},[s("div",{staticClass:"btns_box clearfix"},[s("el-button",{attrs:{type:"primary",size:"mini",plain:"",icon:"el-icon-circle-plus"},on:{click:function(e){t.handleClick("add")}}},[t._v("新增分组")])],1),t._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{data:t.tableData,stripe:"",border:"",height:"300","tooltip-effect":"dark"}},[s("el-table-column",{attrs:{label:"序号",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}])}),t._v(" "),s("el-table-column",{attrs:{sortable:"",prop:"groupName",width:"200",label:"组名"}}),t._v(" "),s("el-table-column",{attrs:{prop:"remarks","min-width":"200",sortable:"",label:"描述","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"createTime",width:"200",sortable:"",label:"创建时间"}}),t._v(" "),s("el-table-column",{attrs:{sortable:"",width:"140",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.handleClick("edit",a.row)}}},[t._v("修改")])]}}])})],1),t._v(" "),s("div",{staticClass:"info_tab_footer"},[t._v("共计:"+t._s(t.dataTotal)+" "),s("div",{staticClass:"show_pager"},[s("Pager",{ref:"pager",attrs:{total:t.dataTotal},on:{change:t.handlePageChange}})],1)]),t._v(" "),t.innerVisible?s("div",[s("salesman-dialog",{attrs:{innerVisible:t.innerVisible,formData:t.formData},on:{changge:t.changge}})],1):t._e()],1)},staticRenderFns:[]};a.a=s},juIs:function(e,a,t){"use strict";var s={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"tms-pagenation"},[t("span",{staticClass:"page-num",class:{disabled:a.pageNum<=1},on:{click:function(e){a.jumpTo(1)}}},[t("span",{staticClass:"first-page"})]),t("span",{staticClass:"page-num",class:{disabled:a.pageNum<=1},on:{click:function(e){a.jumpTo(a.pageNum-1)}}},[t("span",{staticClass:"prev-page"})]),a._v(" "),t("span",{staticClass:"page-jumper"},[a._v("\n    第\n    "),t("el-input",{ref:"input",staticClass:"el-pagination__editor is-in-pagination",attrs:{min:1,max:a.pages,type:"number",disabled:a.pages<=1},on:{change:a.handleChange,focus:a.handleFocus,blur:a.handleBlur},nativeOn:{keydown:function(e){return a.handleKeyup(e)}},model:{value:a.inputval,callback:function(e){a.inputval="string"==typeof e?e.trim():e},expression:"inputval"}}),a._v(" 页\n  ")],1),a._v("\n  /共 "+a._s(a.pages)+" 页\n  "),t("span",{staticClass:"page-num",class:{disabled:a.pageNum===a.pages},on:{click:function(e){a.jumpTo(a.pageNum+1)}}},[t("span",{staticClass:"next-page"})]),a._v(" "),t("span",{staticClass:"page-num",class:{disabled:a.pageNum===a.pages},on:{click:function(e){a.jumpTo(a.pages)}}},[t("span",{staticClass:"last-page"})]),a._v(" "),t("span",{staticClass:"tms-pagination__sizes"},[t("el-select",{staticClass:"page-select",attrs:{placeholder:"请选择"},on:{change:a.sizesChange},model:{value:a.size,callback:function(e){a.size=e},expression:"size"}},a._l(a.sizes,function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})}))],1)])},staticRenderFns:[]};a.a=s},xxjM:function(e,a){}});